name: Optivex Secure Deploy

on:
  push:
    branches: [ main ] # მხოლოდ მაშინ, როცა კოდი მზად არის

jobs:
  lint-and-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Install Dependencies
        run: npm install
      - name: Run Quality Check
        run: npx eslint . # თუ აქ შეცდომას იპოვის, პროცესი გაჩერდება!

  deploy-to-hostinger:
    needs: lint-and-test # ეს ნიშნავს: "არ გაუშვა, თუ ტესტი ჩაიჭრა"
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Sync with Hostinger
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          server-dir: /public_html/ # შენი საიტის საქაღალდე Hostinger-ზე